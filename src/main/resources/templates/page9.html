<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nouvelle vente - ENI-Enchères</title>
  <link rel="stylesheet" th:href="@{/css/view-accueil-encheres.css}">
</head>

<body>
<header>
	<nav>
		<a href="@{/encheres}" class="text-decoration-none text-dark">ENI-Enchères</a>
	</nav>
</header>

<form th:action="@{/vendreArticle}" method="post" th:object="${article}">

  <h1>Nouvelle vente</h1>

  <!--  recuperation des données avec des champs cachés -->
  <input type="hidden" id="idArticle" th:field="*{idArticle}">
  <input type="hidden" th:field="*{utilisateur.idUtilisateur}">
  <input type="hidden" th:field="*{etatVente}">
  
  <ul>
    <li>
      <!-- Champ nom de l'article -->
      <label for="article">Article :</label>
      <input type="text" id="article" th:field="*{nomArticle}" required>

      <span th:errors="*{nomArticle}"></span>
    </li>
    <li>
      <!-- Champ description -->
      <label for="description">Description :</label>
      <textarea id="description" th:field="*{description}" rows="4" required></textarea>

      <span th:errors="*{description}"></span>
    </li>
    <li>
      <!-- Champ prix de départ -->
      <label for="prix">Mise à prix (points) :</label>
      <input type="number" id="prix" th:field="*{miseAPrix}" min="1" required>

      <span th:errors="*{miseAPrix}"></span>
    </li>
    <li>
      <!-- Champ image (optionnel) -->
      <!-- 
      <label for="image">Image de l'article :</label>
      <input type="file" id="image" name="image" accept="image/*">  
      -->
    </li> 
    <li>
      <!-- Sélection de catégorie -->
      <label for="categorie">Catégorie :</label>
      <select name="idCategorie" id="categorie" required>
        <option value="">-- Sélectionner une catégorie --</option>
        <option th:each="cat : ${categoriesEnSession}"
                th:value="${cat.idCategorie}"
                th:text="${cat.libelle}"
                th:selected="${idCategorie} == ${cat.idCategorie}">
          Catégorie
        </option>
      </select>
      <!-- <div th:if="${#fields.hasErrors('categorie')}" class="error">  
        <span th:errors="*{categorie}"></span>
      </div>
      -->

    </li>
    <li>
      <!--  date début enchere -->
      <label for="dateDebutEnchere">Début de l'enchère</label>
      <input type="datetime-local" id="dateDebut"  min="2025-07-09" th:field="*{dateDebutEnchere}" required>
    
   		<span th:errors="*{dateDebutEnchere}"></span>
    </li>
    <li>
      <!-- Date de fin d'enchère -->
      <label for="dateFinEnchere">Fin de l'enchère :</label>
      <input type="datetime-local" id="dateFin" th:field="*{dateFinEnchere}" required>
      <span th:errors="*{dateFinEnchere}"></span>
    </li>
  </ul>

  <!-- Section retrait -->
  <fieldset th:object="${retrait}">
    <legend>Retrait</legend>

    <label for="rue">Rue :</label>
    <input type="text" id="rue" th:field="*{rue}" required>
    <div th:if="${#fields.hasErrors('rue')}" class="error">
      <span th:errors="*{rue}"></span>
    </div>

    <label for="codePostal">Code postal :</label>
    <input type="text" id="codePostal" th:field="*{codePostal}" pattern="[0-9]{5}" required>
    <div th:if="${#fields.hasErrors('codePostal')}" class="error">
      <span th:errors="*{codePostal}"></span>
    </div>

    <label for="ville">Ville :</label>
    <input type="text" id="ville" th:field="*{ville}" required>
    <div th:if="${#fields.hasErrors('ville')}" class="error">
      <span th:errors="*{ville}"></span>
    </div>
  </fieldset>

  <!-- Boutons d'action -->
  <div class="buttons">
    <button type="submit">Enregistrer</button>
   <button type="button" class="cancel" th:onclick="'location.href=\'' + @{/encheres} + '\''">Annuler</button> 
  </div>
	
</form>
 
 <!--  <a th:href="@{/}" class="btn btn-outline-dark px-4">Annuler</a> -->

<!-- Navigation -->
<!-- <nav class="navigation">
  <a th:href="@{/encheres}">← Retour aux enchères</a>
</nav>

<script th:inline="javascript">
  // Validation côté client
  document.querySelector('form').addEventListener('submit', function(e) {
    const dateFin = new Date(document.getElementById('dateFin').value);
    const maintenant = new Date();

    if (dateFin <= maintenant) {
      alert('La date de fin doit être postérieure à maintenant');
      e.preventDefault();
    }
  });
</script> -->
</body>
</html>



<!-- TEST -->


<!--<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Nouvelle vente - ENI-Enchères</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Créer une nouvelle vente</h1>
  <form>
    <label for="article">Nom de l’article :</label>
    <input type="text" id="article" name="article" required>

    <label for="description">Description :</label>
    <textarea id="description" name="description" rows="4" required></textarea>

    <label for="prix">Prix de départ (€) :</label>
    <input type="number" id="prix" name="prix" required>

    <label for="categorie">Catégorie :</label>
    <select id="categorie" name="categorie">
      <option>Informatique</option>
      <option>Mobilier</option>
      <option>Livres</option>
    </select>

    <label for="dateFin">Date de fin d’enchère :</label>
    <input type="date" id="dateFin" name="dateFin">

    <div class="buttons">
      <button type="submit">Valider</button>
      <button type="button" class="cancel">Annuler</button>
    </div>
  </form>
</body>
</html> -->
